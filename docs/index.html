<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>JPG → AVIF Karşılaştırma</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#0f1733;
      --card2:#101a3a;
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.7);
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1200px 800px at 10% 0%, #1a2a6a 0%, rgba(26,42,106,0) 55%),
                  radial-gradient(900px 700px at 100% 0%, #5a2a72 0%, rgba(90,42,114,0) 55%),
                  var(--bg);
      overflow-x:hidden;
    }

    /* Page layout */
    .shell{
      min-height: 100svh;
      display:flex;
      flex-direction:column;
      padding: max(10px, env(safe-area-inset-top)) 10px max(10px, env(safe-area-inset-bottom));
      gap:10px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 14px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width: 220px;
    }
    .brand .title{
      font-weight: 800;
      letter-spacing: .2px;
      font-size: 16px;
      line-height: 1.15;
    }
    .brand .sub{
      color:var(--muted);
      font-size: 12px;
      line-height: 1.25;
    }

    .controls{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }

    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 700;
      font-size: 13px;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:hover{ background: rgba(255,255,255,.08); }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary{ font-weight: 700; opacity:.95; }
    .btn.icon{ padding: 10px 10px; min-width: 42px; text-align:center; }

    .file{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 9px 10px;
      border:1px dashed rgba(255,255,255,.25);
      background: rgba(255,255,255,.04);
      border-radius: 12px;
    }
    input[type="file"]{
      color:var(--muted);
      max-width: 220px;
    }

    .kpi{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 8px 10px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(120,170,255,.22), rgba(120,170,255,.10));
      border: 1px solid rgba(120,170,255,.35);
      white-space: nowrap;
    }
    .kpi .pct{
      font-size: 20px;
      font-weight: 900;
      letter-spacing: .2px;
    }
    .kpi .sub{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      opacity:.85;
    }
    .kpi .hint{
      color:var(--muted);
      font-size: 12px;
      line-height: 1.15;
      margin-left: 6px;
    }

    .status{
      color:var(--muted);
      font-size: 12px;
      padding: 0 4px;
    }

    /* Stage */
    .stage{
      flex:1;
      min-height: 0;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
      box-shadow: var(--shadow);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 1fr;
    }

    .pane{
      position:relative;
      min-height: 0;
      border-right:1px solid var(--line);
      background: rgba(0,0,0,.10);
    }
    .pane:last-child{ border-right:none; }

    .badge{
      position:absolute;
      top:12px;
      left:12px;
      z-index: 3;
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      font-size: 12px;
      font-weight: 800;
      letter-spacing: .2px;
    }
    .badge .meta{
      color: var(--muted);
      font-weight: 700;
      letter-spacing: 0;
    }

    .viewport{
      position:absolute;
      inset:0;
      overflow:hidden;
      touch-action: none; /* mobil pinch/pan eventleri */
      cursor: grab;
    }
    .viewport:active{ cursor: grabbing; }

    .canvas{
      position:absolute;
      left:50%;
      top:50%;
      transform: translate(-50%,-50%) scale(1);
      transform-origin: 0 0;
      will-change: transform;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .pane img{
      display:none;             /* src yoksa kırık ikon görünmesin */
      max-width: none;
      max-height: none;
      user-select: none;
      -webkit-user-drag: none;
      pointer-events: none;     /* pan/zoom viewport’tan */
    }
    .pane img.has-src{ display:block; }

    .footer{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 6px 2px 0;
      color: var(--muted);
      font-size: 12px;
    }

    /* Mobile */
    @media (max-width: 820px){
      .brand{ min-width: unset; }
      .topbar{ gap:10px; }
      input[type="file"]{ max-width: 170px; }
    }
    @media (max-width: 720px){
      .shell{ padding-left: 10px; padding-right: 10px; }
      .topbar{ flex-direction: column; align-items: stretch; }
      .controls{ justify-content: space-between; }
      .stage{
        grid-template-columns: 1fr;
        grid-template-rows: 1fr 1fr;
      }
      .pane{ border-right:none; border-bottom:1px solid var(--line); }
      .pane:last-child{ border-bottom:none; }
      .badge{ top:10px; left:10px; }
      .kpi{ width: 100%; justify-content: space-between; }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="topbar">
      <div class="brand">
        <div class="title">JPG → AVIF Karşılaştırma</div>
        <div class="sub">Mobilde pinch-zoom, pan, çift tıkla sıfırla. Demo otomatik açılır.</div>
      </div>

      <div class="controls">
        <div class="file">
          <input id="file" type="file" accept="image/*" />
          <button id="convert" class="btn">AVIF’e çevir</button>
        </div>

        <div class="kpi" id="kpi" aria-live="polite">
          <span class="pct" id="pct">—</span>
          <span class="sub" id="sizes">—</span>
          <span class="hint" id="kpiHint"></span>
        </div>

        <div style="display:flex; gap:8px;">
          <button id="zoomOut" class="btn icon" title="Zoom out">−</button>
          <button id="zoomIn" class="btn icon" title="Zoom in">+</button>
          <button id="reset" class="btn secondary" title="Reset">Sıfırla</button>
        </div>
      </div>
    </div>

    <div class="status" id="status"></div>

    <div class="stage" id="stage">
      <div class="pane">
        <div class="badge">Original <span class="meta" id="metaLeft"></span></div>
        <div class="viewport" id="vp1">
          <div class="canvas" id="cv1">
            <img id="imgOriginal" alt="Original" />
          </div>
        </div>
      </div>

      <div class="pane">
        <div class="badge">AVIF <span class="meta" id="metaRight"></span></div>
        <div class="viewport" id="vp2">
          <div class="canvas" id="cv2">
            <img id="imgAvif" alt="AVIF" />
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div>İpucu: Tek parmakla sürükle, iki parmakla yakınlaştır/uzaklaştır.</div>
      <div id="download"></div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
